AWSTemplateFormatVersion: '2010-09-09'
Description: AWS SimuLearn - Cloud First Steps

Resources:
  LabVpc:
    Type: AWS::EC2::VPC
    DeletionPolicy: Delete
    Properties:
      CidrBlock: 10.0.0.0/16
      Tags:
        - Key: lab1
          Value: production

  PublicSubnetSubnet1:
    Type: AWS::EC2::Subnet
    DeletionPolicy: Delete
    Properties:
      VpcId: !Ref LabVpc
      AvailabilityZone: us-east-1a
      CidrBlock: 10.0.0.0/24
      MapPublicIpOnLaunch: true

  PublicSubnetSubnet2:
    Type: AWS::EC2::Subnet
    DeletionPolicy: Delete
    Properties:
      VpcId: !Ref LabVpc
      AvailabilityZone: us-east-1b
      CidrBlock: 10.0.1.0/24
      MapPublicIpOnLaunch: true
    # Security Group
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    DeletionPolicy: Delete
    Properties:
      GroupDescription: Allow http to client host
      VpcId: !Ref LabVpc
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0

  WebServer01:
    Type: AWS::EC2::Instance
    DeletionPolicy: Delete
    Properties:
      ImageId: ami-00a929b66ed6e0de6
      InstanceType: t3.micro
      BlockDeviceMappings:
        - DeviceName: /dev/sdm
          Ebs:
            VolumeType: gp3
            Iops: 3000
            DeleteOnTermination: true
            VolumeSize: 8
      UserData: IyEvYmluL2Jhc2gKc3VkbyB5dW0gdXBkYXRlIC15CnN1ZG8geXVtIGluc3RhbGwgLXkgaHR0cGQKc3VkbyB5dW0gaW5zdGFsbCAteSBnaXQKZXhwb3J0IFRPS0VOPWBjdXJsIC1YIFBVVCAiaHR0cDovLzE2OS4yNTQuMTY5LjI1NC9sYXRlc3QvYXBpL3Rva2VuIiAtSCAiWC1hd3MtZWMyLW1ldGFkYXRhLXRva2VuLXR0bC1zZWNvbmRzOiAyMTYwMCJgCmV4cG9ydCBNRVRBX0lOU1RfSUQ9YGN1cmwgaHR0cDovLzE2OS4yNTQuMTY5LjI1NC9sYXRlc3QvbWV0YS1kYXRhL2luc3RhbmNlLWlkIC1IICJYLWF3cy1lYzItbWV0YWRhdGEtdG9rZW46ICRUT0tFTiJgCmV4cG9ydCBNRVRBX0lOU1RfVFlQRT1gY3VybCBodHRwOi8vMTY5LjI1NC4xNjkuMjU0L2xhdGVzdC9tZXRhLWRhdGEvaW5zdGFuY2UtdHlwZSAtSCAiWC1hd3MtZWMyLW1ldGFkYXRhLXRva2VuOiAkVE9LRU4iYApleHBvcnQgTUVUQV9JTlNUX0FaPWBjdXJsIGh0dHA6Ly8xNjkuMjU0LjE2OS4yNTQvbGF0ZXN0L21ldGEtZGF0YS9wbGFjZW1lbnQvYXZhaWxhYmlsaXR5LXpvbmUgLUggIlgtYXdzLWVjMi1tZXRhZGF0YS10b2tlbjogJFRPS0VOImAKY2QgL3Zhci93d3cvaHRtbAplY2hvICI8IURPQ1RZUEUgaHRtbD4iID4+IGluZGV4Lmh0bWwKZWNobyAiPGh0bWwgbGFuZz0iZW4iPiIgPj4gaW5kZXguaHRtbAplY2hvICI8aGVhZD4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04Ij4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wIj4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgIDxzdHlsZT4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICBAaW1wb3J0IHVybCgnaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3M/ZmFtaWx5PU9wZW4rU2FucyZkaXNwbGF5PXN3YXAnKTsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICBodG1sIHsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBvdmVyZmxvdy14OiBoaWRkZW4gIWltcG9ydGFudDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICB9IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgKiB7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgfSIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgIGJvZHkgeyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBmb250LWZhbWlseTogJ09wZW4gU2FucycsIHNhbnMtc2VyaWY7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIGNvbG9yOiAjMzI0ZTYzOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgIH0iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAud3JhcHBlciB7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIHdpZHRoOiAxMDAlOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICB3aWR0aDogMTAwJTsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgaGVpZ2h0OiBhdXRvOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBtaW4taGVpZ2h0OiA5MHZoOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBwYWRkaW5nOiA1MHB4IDIwcHg7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIHBhZGRpbmctdG9wOiAxMDBweDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgZGlzcGxheTogZmxleDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICB9IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgLmluc3RhbmNlLWNhcmQgeyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICB3aWR0aDogMTAwJTsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgbWluLWhlaWdodDogMzgwcHg7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIG1hcmdpbjogYXV0bzsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgYm94LXNoYWRvdzogMTJweCAxMnB4IDJweCAxcHggcmdiYSgxMywgMjgsIDM5LCAwLjQpOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZmZmOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBib3JkZXItcmFkaXVzOiAxNXB4OyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBib3JkZXItd2lkdGg6IDFweDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgbWF4LXdpZHRoOiA1MDBweDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBib3JkZXI6IHRoaW4gZ3Jvb3ZlICM5YzgzZmY7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgfSIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgIC5pbnN0YW5jZS1jYXJkX19jbnQgeyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBtYXJnaW4tdG9wOiAzNXB4OyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIHBhZGRpbmc6IDAgMjBweDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgcGFkZGluZy1ib3R0b206IDQwcHg7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAuM3M7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgfSIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgIC5pbnN0YW5jZS1jYXJkX19uYW1lIHsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDcwMDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgZm9udC1zaXplOiAyNHB4OyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBjb2xvcjogIzY5NDRmZjsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICB9IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgLmluc3RhbmNlLWNhcmQtaW5mX19pdGVtIHsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgcGFkZGluZzogMTBweCAzNXB4OyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBtaW4td2lkdGg6IDE1MHB4OyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgIH0iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAuaW5zdGFuY2UtY2FyZC1pbmZfX3RpdGxlIHsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDcwMDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgZm9udC1zaXplOiAyN3B4OyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBjb2xvcjogIzMyNGU2MzsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICB9IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgLmluc3RhbmNlLWNhcmQtaW5mX190eHQgeyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBmb250LXdlaWdodDogNTAwOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBtYXJnaW4tdG9wOiA3cHg7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgfSIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgPC9zdHlsZT4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgIDx0aXRsZT5BbWF6b24gRUMyIFN0YXR1czwvdGl0bGU+IiA+PiBpbmRleC5odG1sCmVjaG8gIjwvaGVhZD4iID4+IGluZGV4Lmh0bWwKZWNobyAiPGJvZHk+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICA8ZGl2IGNsYXNzPSJ3cmFwcGVyIj4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICA8ZGl2IGNsYXNzPSJpbnN0YW5jZS1jYXJkIj4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5zdGFuY2UtY2FyZF9fY250Ij4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Imluc3RhbmNlLWNhcmRfX25hbWUiPllvdXIgRUMyIEluc3RhbmNlIGlzIHJ1bm5pbmchPC9kaXY+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnN0YW5jZS1jYXJkLWluZiI+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5zdGFuY2UtY2FyZC1pbmZfX2l0ZW0iPiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnN0YW5jZS1jYXJkLWluZl9fdHh0Ij5JbnN0YW5jZSBJZDwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnN0YW5jZS1jYXJkLWluZl9fdGl0bGUiPiIgJE1FVEFfSU5TVF9JRCAiPC9kaXY+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgICAgICAgICAgPC9kaXY+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5zdGFuY2UtY2FyZC1pbmZfX2l0ZW0iPiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnN0YW5jZS1jYXJkLWluZl9fdHh0Ij5JbnN0YW5jZSBUeXBlPC9kaXY+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Imluc3RhbmNlLWNhcmQtaW5mX190aXRsZSI+IiAkTUVUQV9JTlNUX1RZUEUgIjwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgICAgIDwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Imluc3RhbmNlLWNhcmQtaW5mX19pdGVtIj4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5zdGFuY2UtY2FyZC1pbmZfX3R4dCI+QXZhaWxhYmlsaXR5IHpvbmU8L2Rpdj4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5zdGFuY2UtY2FyZC1pbmZfX3RpdGxlIj4iICRNRVRBX0lOU1RfQVogIjwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgICAgIDwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgPC9kaXY+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIDwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgIDwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICI8L2JvZHk+IiA+PiBpbmRleC5odG1sCmVjaG8gIjwvaHRtbD4iID4+IGluZGV4Lmh0bWwKc3VkbyBzZXJ2aWNlIGh0dHBkIHN0YXJ0
      NetworkInterfaces:
        - AssociatePublicIpAddress: true
          DeviceIndex: 0
          SubnetId: !Ref PublicSubnetSubnet1
          GroupSet:
            - !Ref InstanceSecurityGroup
  WebServer02:
    Type: AWS::EC2::Instance
    DeletionPolicy: Delete
    Properties:
      ImageId: ami-00a929b66ed6e0de6
      InstanceType: t3.micro
      BlockDeviceMappings:
        - DeviceName: /dev/sdm
          Ebs:
            VolumeType: gp3
            Iops: 3000
            DeleteOnTermination: true
            VolumeSize: 8
      UserData: IyEvYmluL2Jhc2gKc3VkbyB5dW0gdXBkYXRlIC15CnN1ZG8geXVtIGluc3RhbGwgLXkgaHR0cGQKc3VkbyB5dW0gaW5zdGFsbCAteSBnaXQKZXhwb3J0IFRPS0VOPWBjdXJsIC1YIFBVVCAiaHR0cDovLzE2OS4yNTQuMTY5LjI1NC9sYXRlc3QvYXBpL3Rva2VuIiAtSCAiWC1hd3MtZWMyLW1ldGFkYXRhLXRva2VuLXR0bC1zZWNvbmRzOiAyMTYwMCJgCmV4cG9ydCBNRVRBX0lOU1RfSUQ9YGN1cmwgaHR0cDovLzE2OS4yNTQuMTY5LjI1NC9sYXRlc3QvbWV0YS1kYXRhL2luc3RhbmNlLWlkIC1IICJYLWF3cy1lYzItbWV0YWRhdGEtdG9rZW46ICRUT0tFTiJgCmV4cG9ydCBNRVRBX0lOU1RfVFlQRT1gY3VybCBodHRwOi8vMTY5LjI1NC4xNjkuMjU0L2xhdGVzdC9tZXRhLWRhdGEvaW5zdGFuY2UtdHlwZSAtSCAiWC1hd3MtZWMyLW1ldGFkYXRhLXRva2VuOiAkVE9LRU4iYApleHBvcnQgTUVUQV9JTlNUX0FaPWBjdXJsIGh0dHA6Ly8xNjkuMjU0LjE2OS4yNTQvbGF0ZXN0L21ldGEtZGF0YS9wbGFjZW1lbnQvYXZhaWxhYmlsaXR5LXpvbmUgLUggIlgtYXdzLWVjMi1tZXRhZGF0YS10b2tlbjogJFRPS0VOImAKY2QgL3Zhci93d3cvaHRtbAplY2hvICI8IURPQ1RZUEUgaHRtbD4iID4+IGluZGV4Lmh0bWwKZWNobyAiPGh0bWwgbGFuZz0iZW4iPiIgPj4gaW5kZXguaHRtbAplY2hvICI8aGVhZD4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04Ij4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wIj4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgIDxzdHlsZT4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICBAaW1wb3J0IHVybCgnaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3M/ZmFtaWx5PU9wZW4rU2FucyZkaXNwbGF5PXN3YXAnKTsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICBodG1sIHsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBvdmVyZmxvdy14OiBoaWRkZW4gIWltcG9ydGFudDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICB9IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgKiB7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgfSIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgIGJvZHkgeyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBmb250LWZhbWlseTogJ09wZW4gU2FucycsIHNhbnMtc2VyaWY7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIGNvbG9yOiAjMzI0ZTYzOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgIH0iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAud3JhcHBlciB7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIHdpZHRoOiAxMDAlOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICB3aWR0aDogMTAwJTsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgaGVpZ2h0OiBhdXRvOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBtaW4taGVpZ2h0OiA5MHZoOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBwYWRkaW5nOiA1MHB4IDIwcHg7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIHBhZGRpbmctdG9wOiAxMDBweDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgZGlzcGxheTogZmxleDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICB9IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgLmluc3RhbmNlLWNhcmQgeyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICB3aWR0aDogMTAwJTsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgbWluLWhlaWdodDogMzgwcHg7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIG1hcmdpbjogYXV0bzsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgYm94LXNoYWRvdzogMTJweCAxMnB4IDJweCAxcHggcmdiYSgxMywgMjgsIDM5LCAwLjQpOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZmZmOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBib3JkZXItcmFkaXVzOiAxNXB4OyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBib3JkZXItd2lkdGg6IDFweDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgbWF4LXdpZHRoOiA1MDBweDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBib3JkZXI6IHRoaW4gZ3Jvb3ZlICM5YzgzZmY7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgfSIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgIC5pbnN0YW5jZS1jYXJkX19jbnQgeyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBtYXJnaW4tdG9wOiAzNXB4OyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIHBhZGRpbmc6IDAgMjBweDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgcGFkZGluZy1ib3R0b206IDQwcHg7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAuM3M7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgfSIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgIC5pbnN0YW5jZS1jYXJkX19uYW1lIHsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDcwMDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgZm9udC1zaXplOiAyNHB4OyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBjb2xvcjogIzY5NDRmZjsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICB9IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgLmluc3RhbmNlLWNhcmQtaW5mX19pdGVtIHsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgcGFkZGluZzogMTBweCAzNXB4OyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBtaW4td2lkdGg6IDE1MHB4OyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgIH0iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAuaW5zdGFuY2UtY2FyZC1pbmZfX3RpdGxlIHsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDcwMDsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgZm9udC1zaXplOiAyN3B4OyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBjb2xvcjogIzMyNGU2MzsiID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICB9IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgLmluc3RhbmNlLWNhcmQtaW5mX190eHQgeyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBmb250LXdlaWdodDogNTAwOyIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICBtYXJnaW4tdG9wOiA3cHg7IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgfSIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgPC9zdHlsZT4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgIDx0aXRsZT5BbWF6b24gRUMyIFN0YXR1czwvdGl0bGU+IiA+PiBpbmRleC5odG1sCmVjaG8gIjwvaGVhZD4iID4+IGluZGV4Lmh0bWwKZWNobyAiPGJvZHk+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICA8ZGl2IGNsYXNzPSJ3cmFwcGVyIj4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICA8ZGl2IGNsYXNzPSJpbnN0YW5jZS1jYXJkIj4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5zdGFuY2UtY2FyZF9fY250Ij4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Imluc3RhbmNlLWNhcmRfX25hbWUiPllvdXIgRUMyIEluc3RhbmNlIGlzIHJ1bm5pbmchPC9kaXY+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnN0YW5jZS1jYXJkLWluZiI+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5zdGFuY2UtY2FyZC1pbmZfX2l0ZW0iPiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnN0YW5jZS1jYXJkLWluZl9fdHh0Ij5JbnN0YW5jZSBJZDwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnN0YW5jZS1jYXJkLWluZl9fdGl0bGUiPiIgJE1FVEFfSU5TVF9JRCAiPC9kaXY+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgICAgICAgICAgPC9kaXY+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5zdGFuY2UtY2FyZC1pbmZfX2l0ZW0iPiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnN0YW5jZS1jYXJkLWluZl9fdHh0Ij5JbnN0YW5jZSBUeXBlPC9kaXY+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Imluc3RhbmNlLWNhcmQtaW5mX190aXRsZSI+IiAkTUVUQV9JTlNUX1RZUEUgIjwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgICAgIDwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Imluc3RhbmNlLWNhcmQtaW5mX19pdGVtIj4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5zdGFuY2UtY2FyZC1pbmZfX3R4dCI+QXZhaWxhYmlsaXR5IHpvbmU8L2Rpdj4iID4+IGluZGV4Lmh0bWwKZWNobyAiICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5zdGFuY2UtY2FyZC1pbmZfX3RpdGxlIj4iICRNRVRBX0lOU1RfQVogIjwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgICAgIDwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgICAgICAgICAgPC9kaXY+IiA+PiBpbmRleC5odG1sCmVjaG8gIiAgICAgICAgICAgIDwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICIgICAgICAgIDwvZGl2PiIgPj4gaW5kZXguaHRtbAplY2hvICI8L2JvZHk+IiA+PiBpbmRleC5odG1sCmVjaG8gIjwvaHRtbD4iID4+IGluZGV4Lmh0bWwKc3VkbyBzZXJ2aWNlIGh0dHBkIHN0YXJ0
      NetworkInterfaces:
        - AssociatePublicIpAddress: true
          DeviceIndex: 0
          SubnetId: !Ref PublicSubnetSubnet2
          GroupSet:
            - !Ref InstanceSecurityGroup

  MyInternetGateway:
    Type: AWS::EC2::InternetGateway
    DeletionPolicy: Delete

  MyInternetGatewayAttachment:
    Type: AWS::EC2::VPCGatewayAttachment
    DeletionPolicy: Delete
    Properties:
      VpcId: !Ref LabVpc
      InternetGatewayId: !Ref MyInternetGateway

  MyRouteTable:
    Type: AWS::EC2::RouteTable
    DeletionPolicy: Delete
    Properties:
      VpcId: !Ref LabVpc

  MyRoute:
    Type: AWS::EC2::Route
    DeletionPolicy: Delete
    Properties:
      RouteTableId: !Ref MyRouteTable
      DestinationCidrBlock: 0.0.0.0/0
      GatewayId: !Ref MyInternetGateway

  MySubnetRoute1TableAssociation:
    Type: AWS::EC2::SubnetRouteTableAssociation
    DeletionPolicy: Delete
    Properties:
      SubnetId: !Ref PublicSubnetSubnet1
      RouteTableId: !Ref MyRouteTable

  MySubnetRoute2TableAssociation:
    Type: AWS::EC2::SubnetRouteTableAssociation
    DeletionPolicy: Delete
    Properties:
      SubnetId: !Ref PublicSubnetSubnet2
      RouteTableId: !Ref MyRouteTable

Outputs:
  VpcId:
    Description: The VPC ID
    Value: !Ref LabVpc